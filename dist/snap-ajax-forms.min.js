"use strict";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _createForOfIteratorHelper(o,allowArrayLike){var normalCompletion,didErr,err,i,F,it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(it)return didErr=!(normalCompletion=!0),{s:function(){it=it.call(o)},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(_e3){didErr=!0,err=_e3},f:function(){try{normalCompletion||null==it["return"]||it["return"]()}finally{if(didErr)throw err}}};if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length)return it&&(o=it),i=0,{s:F=function F(){},n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e2){throw _e2},f:F};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){var n;if(o)return"string"==typeof o?_arrayLikeToArray(o,minLen):"Map"===(n="Object"===(n=Object.prototype.toString.call(o).slice(8,-1))&&o.constructor?o.constructor.name:n)||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i["return"]&&(_r=_i["return"](),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function ownKeys(object,enumerableOnly){var symbols,keys=Object.keys(object);return Object.getOwnPropertySymbols&&(symbols=Object.getOwnPropertySymbols(object),enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)),keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}function _defineProperty(obj,key,value){return(key=_toPropertyKey(key))in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,_toPropertyKey(descriptor.key),descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}function _toPropertyKey(arg){arg=_toPrimitive(arg,"string");return"symbol"===_typeof(arg)?arg:String(arg)}function _toPrimitive(input,hint){if("object"!==_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(prim===undefined)return("string"===hint?String:Number)(input);input=prim.call(input,hint||"default");if("object"!==_typeof(input))return input;throw new TypeError("@@toPrimitive must return a primitive value.")}
/**
 * SnapAjaxForms.js
 *
 * Instantly turn html form elements into ajax forms by just adding an attribute.
 * 
 * @author Nick Adams
 * @see {@link https://github.com/nickolasjadams/snap-ajax-forms|Repository}
 * @license MIT
 * @version 1.0.0
 */var SnapAjaxForms=function(){function SnapAjaxForms(options){_classCallCheck(this,SnapAjaxForms),this.selector="form[data-ajax]",this.submitDisabledDuration=1500,this.recaptcha={version:"v3"},this.onDone="",options&&(options.selector&&(this.selector=options.selector),options.submitDisabledDuration&&(this.submitDisabledDuration=options.submitDisabledDuration),options.recaptcha)&&(this.recaptcha=_objectSpread(_objectSpread({},this.recaptcha),options.recaptcha),parseInt(this.recaptcha.version)?this.recaptcha.version="v"+this.recaptcha.version:this.recaptcha.version=this.recaptcha.version.toLowerCase(),"v3"!==this.recaptcha.version&&console.warn("Only reCAPTCHA v3 is supported at this time."),this.recaptcha.siteKey||console.warn("reCAPTCHA siteKey must be set.")),this.forms=document.querySelectorAll(this.selector),this.addFormEventListeners()}return _createClass(SnapAjaxForms,[{key:"addFormEventListeners",value:function(){var _this=this;this.forms.forEach(function(form){form.addEventListener("submit",function(e){e.preventDefault();var e=_slicedToArray(_this.prepFormData(this,e),3),form=e[0],data=e[1],submitter=e[2];""===form.dataset.ajaxRecaptcha?"undefined"==typeof window.grecaptcha?console.warn("reCAPTCHA objects couldn't be found. Have the scripts been loaded?"):window.grecaptcha.ready(function(){window.grecaptcha.execute(_this.recaptcha.siteKey,{action:"submit"}).then(function(token){data.recaptcha_token=token,_this.sendXhrRequest(form,data,submitter)})}):_this.sendXhrRequest(form,data,submitter)},!1)})}},{key:"prepFormData",value:function(form,submissionEvent){this.onDone=window[form.getAttribute("data-ajax-done")];var _step,submissionEvent=submissionEvent.submitter,formData=new FormData(form,submissionEvent),data=(submissionEvent&&(submissionEvent.disabled="disabled"),{}),_iterator=_createForOfIteratorHelper(formData);try{for(_iterator.s();!(_step=_iterator.n()).done;){var isSubmissionElement,isRadioElement,isMultipleSelect,isMultipleFiles,_step$value=_slicedToArray(_step.value,2),key=_step$value[0],formElements=(_step$value[1],document.querySelectorAll("[name='"+key+"']"));1<formElements.length?(isSubmissionElement="INPUT"===formElements[0].tagName&&"submit"===formElements[0].type||"BUTTON"===formElements[0].tagName&&"button"!==formElements[0].type,isRadioElement="INPUT"===formElements[0].tagName&&"radio"===formElements[0].type,data[key]=isSubmissionElement||isRadioElement?formData.get(key):formData.getAll(key)):(isMultipleSelect="SELECT"===formElements[0].tagName&&formElements[0].attributes.multiple,isMultipleFiles="INPUT"===formElements[0].tagName&&formElements[0].attributes.multiple,data[key]=isMultipleSelect||isMultipleFiles?formData.getAll(key):formData.get(key))}}catch(err){_iterator.e(err)}finally{_iterator.f()}return[form,data,submissionEvent]}},{key:"sendXhrRequest",value:function(form,data,submitter){var _this=this;$.ajax({url:form.action,method:form.method,data:data,processData:!1,contentType:!1,beforeSend:function(){submitter&&setTimeout(function(){submitter.removeAttribute("disabled")},_this.submitDisabledDuration)}}).fail(function(data){var errors;(data.responseJSON||data.errors)&&(data.responseJSON?data.responseJSON.errors&&(errors=data.responseJSON.errors):data.errors&&(errors=data.errors),form.querySelectorAll("[data-ajax-errors]").forEach(function(errorElement){errorElement.innerHTML=""}),errors)&&Object.entries(errors).forEach(function(entry){var key=entry[0],entry=entry[1].messages,errorElement=form.querySelector('[data-ajax-errors="'.concat(key,'"]'));errorElement&&entry.forEach(function(message){errorElement.insertAdjacentHTML("afterbegin","<div>".concat(message,"</div>"))})})}).done(function(data){var id;form.reset(),document.querySelectorAll("[data-ajax-errors]").forEach(function(element){element.innerHTML=""}),"function"==typeof _this.onDone&&_this.onDone(data),form.id&&(id=form.id.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[\s_]+/g,"-").toLowerCase(),form.dispatchEvent(new CustomEvent(id+"-submit"),{detail:data}))})}}]),SnapAjaxForms}();